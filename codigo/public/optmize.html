<!-- optimize.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Otimização de Pull Request</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="max-w-4xl mx-auto py-10 px-6">
    <h1 class="text-2xl font-bold mb-6">Otimização do Prompt do Pull Request</h1>

    <label for="promptEditor" class="block font-semibold mb-2">Edite o Prompt</label>
    <textarea id="promptEditor" rows="10" class="w-full p-4 border rounded shadow-sm text-sm font-mono"
      placeholder="Exemplo: Gere um pull request com base nos seguintes commits...">
Gere um Pull Request em markdown com base nas seguintes informações:
- Commits: {{commits}}
- Tipo: {{tipo}}
- Escopo: {{escopo}}
- Branch: {{branch}}
- Descrição: {{descricao}}
      </textarea>

    <div class="flex justify-between mt-4">
      <button onclick="salvarPrompt()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Salvar Prompt</button>
      <button onclick="mostrarPreview()" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">Pré-visualizar</button>
    </div>

    <div id="preview" class="mt-6 bg-white p-4 border rounded shadow-sm text-sm font-mono whitespace-pre-wrap hidden"></div>
  </div>

  <script>
    const previewDiv = document.getElementById("preview");
    const promptEditor = document.getElementById("promptEditor");

    // Carrega prompt salvo
    window.onload = () => {
      const salvo = localStorage.getItem("promptCustomizado");
      if (salvo) promptEditor.value = salvo;
    };

    function salvarPrompt() {
      localStorage.setItem("promptCustomizado", promptEditor.value);
      alert("Prompt salvo com sucesso!");
    }

    function mostrarPreview() {
      const modelo = promptEditor.value;
      const substituido = modelo
        .replace('{{commits}}', '- feat: tela de login\n- fix: erro ao deletar repositório')
        .replace('{{tipo}}', 'feature')
        .replace('{{escopo}}', 'autenticação')
        .replace('{{branch}}', 'feat/login-system')
        .replace('{{descricao}}', 'Implementação da tela de login com autenticação');

      previewDiv.classList.remove("hidden");
      previewDiv.textContent = substituido;
    }
  </script>
</body>
</html>